<!doctype html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-YS5RQ53S2J"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-YS5RQ53S2J');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AlignPoint Chiropractic</title>
  <meta name="description" content="AlignPoint Chiropractic in Lexington, KY." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css" />

  <style>
    /* Small safety defaults if style.css is missing pieces */
    .nav-list { list-style:none; margin:0; padding:0; display:flex; gap:14px; align-items:center; flex-wrap:wrap; }
    .nav-list > li { position:relative; }
    .nav-link, .nav-btn { font: inherit; background:none; border:0; cursor:pointer; padding:10px 10px; text-decoration:none; display:inline-flex; align-items:center; gap:8px; }
    .has-dropdown .dropdown { display:none; position:absolute; left:0; top:100%; z-index:999; min-width:260px; background:#fff; border:1px solid rgba(0,0,0,.1); border-radius:12px; padding:12px; box-shadow:0 14px 40px rgba(0,0,0,.12); }
    .has-dropdown.open > .dropdown { display:block; }
    .dropdown a { display:block; padding:8px 10px; border-radius:10px; text-decoration:none; }
    .dropdown a:hover { background:rgba(0,0,0,.06); }
    .dropdown-simple {
      display:flex;
      flex-direction:column;
      gap:4px;
      max-width:220px;
    }
    .dropdown-simple a {
      padding:8px 10px;
      border-radius:8px;
      color:#0b5fff;
      font-weight:600;
    }
    .dd-cols { display:grid; grid-template-columns: repeat(3, minmax(160px, 1fr)); gap:10px; }
    .dd-col { padding:6px; }
    .dd-title { font-weight:700; margin:6px 10px; opacity:.85; }
    .chev { width:8px; height:8px; border-right:2px solid currentColor; border-bottom:2px solid currentColor; transform: rotate(45deg); display:inline-block; margin-top:-2px; }
    @media (max-width: 900px){
      .dd-cols { grid-template-columns: 1fr; }
      .has-dropdown .dropdown { position:static; box-shadow:none; border-radius:10px; margin-top:6px; }
      .nav-list { flex-direction:column; align-items:stretch; }
    }
  </style>
</head>

<body class="theme" data-page-slug="disclaimers">
  <a class="skip-link" href="#main">Skip to content</a>

  <header class="site-header" id="top">
    <!-- TOP BAR -->
    <div class="topbar">
      <div class="container topbar-inner">
        <a class="brand" href="/" aria-label="AlignPoint Chiropractic Home">
          <img src="/assets/alignpoint-logo-dark.png" class="brand-logo" alt="AlignPoint Chiropractic">
        </a>

        <button class="nav-toggle" aria-expanded="false" aria-controls="siteNav" aria-label="Open menu">
          <span></span><span></span><span></span>
        </button>

        <div class="topbar-right">
          <div class="header-contact">
            <div class="header-address">
              1132 Winchester Rd
              Suite #125
              Lexington, KY 40505 | <a href="tel:+18592540059">(859) 254-0059</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- MENU BAR (DYNAMIC) -->
    <div class="menubar">
      <div class="container menubar-inner">
        <nav class="site-nav" id="siteNav" aria-label="Primary navigation">
          <!-- We will inject UL here -->
          <ul class="nav-list" id="navList"></ul>
        </nav>
      </div>
    </div>
  </header>

  <main id="main">
    <!-- IGNORE CONTENT (placeholder) -->
    <section class="section">
      <div class="container">
        <div id="alignpoint-content"></div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="footer-map">
      <div class="footer-map-inner">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2274.8435297125293!2d-84.46186809999999!3d38.041728899999995!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x88424514ff3aa5d1%3A0x4919fe7dfb79c522!2s1132%20Winchester%20Rd%20%23125%2C%20Lexington%2C%20KY%2040505!5e1!3m2!1sen!2sus!4v1766758410722!5m2!1sen!2sus"
          allowfullscreen
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          aria-label="AlignPoint Chiropractic location map">
        </iframe>
      </div>
    </div>

    <div class="container footer-grid">
      <div>
        <div class="footer-brand">AlignPoint Chiropractic</div>
        <div class="footer-text">
          Dr. Kristian Esteve, D.C. — CEO / Owner<br/>
          1132 Winchester Rd<br/>
          Suite #125<br/>
          Lexington, KY 40505<br/><br/>
          <strong>Main:</strong> <a class="footer-link" href="tel:+18592540059">(859) 254-0059</a><br/>

          <div class="footer-social" aria-label="Social links">
            <a class="social-link" href="#" target="_blank" rel="noopener" aria-label="Facebook">
              <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="M22 12a10 10 0 1 0-11.56 9.88v-6.99H7.9V12h2.54V9.8c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.23.2 2.23.2v2.46h-1.26c-1.24 0-1.63.77-1.63 1.56V12h2.78l-.44 2.89h-2.34v6.99A10 10 0 0 0 22 12z"/>
              </svg>
            </a>

            <a class="social-link" href="#" target="_blank" rel="noopener" aria-label="Instagram">
              <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm10 2H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3z"/>
                <path d="M12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/>
                <path d="M17.5 6.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
              </svg>
            </a>

            <a class="social-link" href="#" target="_blank" rel="noopener" aria-label="TikTok">
              <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="M16.5 3c.3 2.6 2.1 4.4 4.7 4.7V10c-1.7 0-3.2-.6-4.4-1.5v6.3c0 3.6-2.9 6.2-6.4 6.2-3.1 0-5.6-2.1-6.2-4.9-.8-3.9 2.2-7.3 6.1-7.3.4 0 .8 0 1.2.1v2.8c-.4-.2-.9-.3-1.4-.3-2 0-3.6 1.8-3.3 3.9.2 1.5 1.5 2.7 3 2.9 2 .3 3.8-1.2 3.8-3.2V3h2.9z"/>
              </svg>
            </a>

            <a class="social-link" href="#" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="M6 6.5A2.5 2.5 0 1 1 6 1.5a2.5 2.5 0 0 1 0 5zM3.5 22V8.5H8V22H3.5z"/>
                <path d="M10 8.5h4.3v1.8h.1c.6-1.1 2-2.2 4.1-2.2 4.4 0 5.2 2.9 5.2 6.6V22h-4.5v-6.2c0-1.5 0-3.4-2.1-3.4s-2.4 1.6-2.4 3.3V22H10V8.5z"/>
              </svg>
            </a>

            <a class="social-link" href="#" target="_blank" rel="noopener" aria-label="X (Twitter)">
              <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="M18.9 2H22l-6.8 7.8L23 22h-6.7l-5.2-6.8L5.2 22H2l7.3-8.4L1 2h6.9l4.7 6.1L18.9 2zm-1.2 18h1.8L7 3.9H5.1L17.7 20z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>

      <div>
        <div class="footer-title">Menu</div>
        <a class="footer-link" href="/">Home</a><br/>
        <a class="footer-link" href="/about/">About</a><br/>
        <a class="footer-link" href="/conditions/">Conditions</a><br/>
        <a class="footer-link" href="/foot-levelers/">Foot Levelers</a><br/>
        <a class="footer-link" href="/new-patients/">New Patients</a><br/>
        <a class="footer-link" href="/contact/">Contact</a>
      </div>

      <div>
        <div class="footer-title">New Patients</div>
        <a class="footer-link" href="/new-patient-special/">New Patient Special</a><br/>
        <a class="footer-link" href="/what-to-expect/">What to Expect</a><br/>
        <a class="footer-link" href="/patient-portal/">New Patient Portal</a>
      </div>

      <div>
        <div class="footer-title">Office</div>
        <a class="footer-link" href="/about/#faqs">FAQs</a><br/>
        <a class="footer-link" href="/privacy/">Privacy Policy</a><br/>
        <a class="footer-link" href="/terms/">Terms of Service</a><br/>
        <a class="footer-link" href="/disclaimers/">Disclaimers</a>

        <br/><br/>
        <div class="footer-title">Find Us</div>
        <a class="footer-link" href="https://maps.google.com/?q=1132%20Winchester%20Rd%20Suite%20125%2C%20Lexington%2C%20KY%2040505" target="_blank" rel="noopener">Open in Google Maps</a>
      </div>
    </div>

    <div class="container footer-bottom">
      <span>© <span id="year"></span> AlignPoint Chiropractic</span>
      <a class="footer-link" href="#top">Back to top</a>
    </div>

    <style>
      .footer-social{
        display:flex;
        gap:12px;
        flex-wrap:wrap;
        align-items:center;
      }
      .social-link{
        display:inline-flex;
        width:34px;
        height:34px;
        align-items:center;
        justify-content:center;
        border-radius:10px;
        background: rgba(0,0,0,.06);
        transition: transform .12s ease, background .12s ease;
      }
      .social-link:hover{ background: rgba(0,0,0,.10); transform: translateY(-1px); }
      .social-link svg{
        width:18px;
        height:18px;
        fill: currentColor;
      }
    </style>
  </footer>

  <script>
    // ====== CONFIG ======
    const API_BASE = "https://api.adeptlogics.com/public";
    const tenantDomain = "alignpointchiro.com";

    // This API menu is the header menu with dropdown data
    const MENU_SLUG = "header";
    const DEFAULT_SLUG = "home";
    const PAGE_SLUG = document.body.dataset.pageSlug || DEFAULT_SLUG;

    const pagesBySlug = new Map();
    const slugTitleMap = new Map();

    async function fetchJson(endpoint) {
      const res = await fetch(`${API_BASE}${endpoint}`);
      if (!res.ok) throw new Error(`API error ${res.status}`);
      return res.json();
    }

    function buildTree(items = []) {
      const byId = new Map();
      const roots = [];

      for (const it of items) {
        byId.set(it.id, { ...it, children: [] });
      }

      for (const it of byId.values()) {
        if (it.parent_id && byId.has(it.parent_id)) {
          byId.get(it.parent_id).children.push(it);
        } else {
          roots.push(it);
        }
      }

      const sortRec = (nodeList) => {
        nodeList.sort((a, b) => (a.sort_order ?? 0) - (b.sort_order ?? 0));
        nodeList.forEach(n => sortRec(n.children));
      };

      sortRec(roots);
      return roots;
    }

    function ensureSlashPath(path) {
      if (!path) return "/";
      let normalized = path.startsWith("/") ? path : `/${path}`;
      if (normalized === "/") return "/";
      if (!normalized.endsWith("/")) normalized += "/";
      return normalized;
    }

    function normalizeExternalUrl(url) {
      if (!url) return url;
      if (/^https?:\/\//i.test(url) || url.startsWith("//")) return url;
      const parts = url.split("#");
      const base = parts[0].replace(/^\.\//, "").replace(/\.html$/i, "");
      const hash = parts[1];
      const normalizedBase =
        !base || base === "index" ? "/" : ensureSlashPath(base);
      return hash ? `${normalizedBase}#${hash}` : normalizedBase;
    }

    function getHref(item) {
      const external = normalizeExternalUrl(item.external_url);
      if (external) return external;
      if (item.page?.full_path) {
        if (item.page.slug === DEFAULT_SLUG) return "/";
        return ensureSlashPath(item.page.full_path);
      }
      if (item.page?.slug) {
        return item.page.slug === DEFAULT_SLUG ? "/" : ensureSlashPath(item.page.slug);
      }
      return "#";
    }

    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function makeLink(label, href, extraClass) {
      const a = document.createElement("a");
      if (extraClass) a.className = extraClass;
      a.textContent = label || "(no label)";
      a.href = href || "#";
      return a;
    }

    function registerSlug(slug, label) {
      if (!slug) return;
      slugTitleMap.set(slug, label || slug);
    }

    function renderMenuFromItems(items = []) {
      const navList = document.getElementById("navList");
      if (!navList) return;
      navList.innerHTML = "";
      const visible = (items || []).filter(item => item.visible);
      const tree = buildTree(visible);
      tree.forEach(node => navList.appendChild(renderNavItem(node)));
    }

    function renderNavItem(node) {
      const li = document.createElement("li");
      const children = (node.children || []).filter(child => child.visible);
      if (children.length) {
        li.className = "has-dropdown";
        const btn = document.createElement("button");
        btn.className = "nav-link nav-btn";
        btn.type = "button";
        btn.setAttribute("aria-expanded", "false");
        btn.innerHTML = `${escapeHtml(node.label || "Menu")} <span class="chev" aria-hidden="true"></span>`;

        const dropdown = document.createElement("div");
        dropdown.className = "dropdown";
        dropdown.setAttribute("role", "menu");

        const hasNestedChildren = children.some(child => (child.children || []).filter(grand => grand.visible).length);
        if (hasNestedChildren) {
          const cols = document.createElement("div");
          cols.className = "dd-cols";

          children.forEach(child => {
            const col = document.createElement("div");
            col.className = "dd-col";

            const title = document.createElement("div");
            title.className = "dd-title";
            title.textContent = child.label || "Section";
            col.appendChild(title);

            const grandchildren = (child.children || []).filter(grand => grand.visible);
            if (grandchildren.length) {
              grandchildren.forEach(grand => {
                const a = document.createElement("a");
                a.href = getHref(grand);
                a.textContent = grand.label || "(no label)";
                col.appendChild(a);
              });
            } else {
              col.appendChild(createDropdownLink(child));
            }

            cols.appendChild(col);
          });

          dropdown.appendChild(cols);
        } else {
          const simple = document.createElement("div");
          simple.className = "dropdown-simple";
          children.forEach(child => {
            simple.appendChild(createDropdownLink(child));
          });
          dropdown.appendChild(simple);
        }

        li.appendChild(btn);
        li.appendChild(dropdown);

        btn.addEventListener("click", (event) => {
          event.stopPropagation();
          const isOpen = li.classList.toggle("open");
          btn.setAttribute("aria-expanded", String(isOpen));
          if (isOpen) {
            closeDropdowns(li);
          }
        });

        li.addEventListener("keydown", (event) => {
          if (event.key === "Escape") {
            li.classList.remove("open");
            btn.setAttribute("aria-expanded", "false");
            btn.focus();
          }
        });

        return li;
      }

      registerSlug(node.page?.slug, node.label);
      li.appendChild(createNavLink(node.label, getHref(node), node.page?.slug));
      return li;
    }

    function createNavLink(label, href, slug) {
      const link = makeLink(label, href, "nav-link");
      if (slug && slug === PAGE_SLUG) {
        link.classList.add("is-active");
      }
      return link;
    }

    function createDropdownLink(item) {
      const href = getHref(item);
      const link = makeLink(item.label, href);
      registerSlug(item.page?.slug, item.label);
      if (item.page?.slug && item.page.slug === PAGE_SLUG) {
        link.classList.add("is-active");
      }
      return link;
    }

    function renderContent(page, slug) {
      const contentEl = document.getElementById("alignpoint-content");
      if (!contentEl) return;
      if (!page) {
        contentEl.innerHTML = "<p>Content not found.</p>";
        document.title = "AlignPoint Chiropractic";
        return;
      }
      contentEl.innerHTML = page.content || "<p>Content is empty.</p>";
      const label = slugTitleMap.get(slug) || page.slug;
      const title = label ? `AlignPoint Chiropractic | ${label}` : "AlignPoint Chiropractic";
      document.title = title;
    }

    function closeDropdowns(except) {
      document.querySelectorAll(".has-dropdown.open").forEach(li => {
        if (li === except) return;
        li.classList.remove("open");
        const btn = li.querySelector("button.nav-btn");
        if (btn) btn.setAttribute("aria-expanded", "false");
      });
    }

    document.addEventListener("click", () => {
      closeDropdowns();
    });

    (function setupMobileToggle() {
      const toggle = document.querySelector(".nav-toggle");
      const nav = document.getElementById("siteNav");
      if (!toggle || !nav) return;
      toggle.addEventListener("click", () => {
        const expanded = toggle.getAttribute("aria-expanded") === "true";
        toggle.setAttribute("aria-expanded", String(!expanded));
        nav.classList.toggle("open");
      });
    })();

    async function initNav() {
      const domain = encodeURIComponent(tenantDomain);
      const [pages, menus] = await Promise.all([
        fetchJson(`/pages?domain=${domain}`),
        fetchJson(`/pages/menus?domain=${domain}`),
      ]);

      (pages || []).forEach(page => {
        if (page.slug) {
          pagesBySlug.set(page.slug, page);
        }
      });

      const menu = (menus || []).find(m => m.slug === MENU_SLUG) || (menus || [])[0];
      if (menu) {
        renderMenuFromItems(menu.items || []);
      }

      renderContent(pagesBySlug.get(PAGE_SLUG), PAGE_SLUG);
    }

    document.getElementById("year").textContent = String(new Date().getFullYear());

    initNav().catch(err => {
      console.error("Failed to load AlignPoint data", err);
    });
  </script>

  <script src="/js/script.js"></script>
</body>
</html>
